import numpy as np

#a_vec is the unit vector of axis of rotation on the Poincare sphere of the first piezoelectric transducer
#theta_a is the angle that I'd like to rotate about this axis.
def get_polarization_rotation_matrix(thetas,*vecs):
	a_vec = vecs[0]
	b_vec = vecs[1]
	c_vec = vecs[2]
	d_vec = vecs[3]
	ax = a_vec[0]
	ay = a_vec[1]
	az = a_vec[2]
	bx = b_vec[0]
	by = b_vec[1]
	bz = b_vec[2]
	cx = c_vec[0]
	cy = c_vec[1]
	cz = c_vec[2]
	dx = d_vec[0]
	dy = d_vec[1]
	dz = d_vec[2]

	theta_a = thetas[0]
	theta_b = thetas[1]
	theta_c = thetas[2]
	theta_d = thetas[3]
	R = np.zeros((3,3))

	R[0,0] = (np.cos(theta_a)+ax**2*(1-np.cos(theta_a)))*(np.cos(theta_b)+bx**2*(1-np.cos(theta_b)))*(np.cos(theta_c)+cx**2*(1-np.cos(theta_c)))*(np.cos(theta_d)+dx**2*(1-np.cos(theta_d)))+(ax*ay*(1-np.cos(theta_a))+az*np.sin(theta_a))*(bx*by*(1-np.cos(theta_b))-bz*np.sin(theta_b))*(np.cos(theta_c)+cx**2*(1-np.cos(theta_c)))*(np.cos(theta_d)+dx**2*(1-np.cos(theta_d)))+(ax*az*(1-np.cos(theta_a))-ay*np.sin(theta_a))*(bx*bz*(1-np.cos(theta_b))+by*np.sin(theta_b))*(np.cos(theta_c)+cx**2*(1-np.cos(theta_c)))*(np.cos(theta_d)+dx**2*(1-np.cos(theta_d)))+(np.cos(theta_a)+ax**2*(1-np.cos(theta_a)))*(bx*by*(1-np.cos(theta_b))+bz*np.sin(theta_b))*(cx*cy*(1-np.cos(theta_c))-cz*np.sin(theta_c))*(np.cos(theta_d)+dx**2*(1-np.cos(theta_d)))+(ax*ay*(1-np.cos(theta_a))+az*np.sin(theta_a))*(np.cos(theta_b)+by**2*(1-np.cos(theta_b)))*(cx*cy*(1-np.cos(theta_c))-cz*np.sin(theta_c))*(np.cos(theta_d)+dx**2*(1-np.cos(theta_d)))+(ax*az*(1-np.cos(theta_a))-ay*np.sin(theta_a))*(by*bz*(1-np.cos(theta_b))-bx*np.sin(theta_b))*(cx*cy*(1-np.cos(theta_c))-cz*np.sin(theta_c))*(np.cos(theta_d)+dx**2*(1-np.cos(theta_d)))+(np.cos(theta_a)+ax**2*(1-np.cos(theta_a)))*(bx*bz*(1-np.cos(theta_b))-by*np.sin(theta_b))*(cx*cz*(1-np.cos(theta_c))+cy*np.sin(theta_c))*(np.cos(theta_d)+dx**2*(1-np.cos(theta_d)))+(ax*ay*(1-np.cos(theta_a))+az*np.sin(theta_a))*(by*bz*(1-np.cos(theta_b))+bx*np.sin(theta_b))*(cx*cz*(1-np.cos(theta_c))+cy*np.sin(theta_c))*(np.cos(theta_d)+dx**2*(1-np.cos(theta_d)))+(ax*az*(1-np.cos(theta_a))-ay*np.sin(theta_a))*(np.cos(theta_b)+bz**2*(1-np.cos(theta_b)))*(cx*cz*(1-np.cos(theta_c))+cy*np.sin(theta_c))*(np.cos(theta_d)+dx**2*(1-np.cos(theta_d)))+(np.cos(theta_a)+ax**2*(1-np.cos(theta_a)))*(np.cos(theta_b)+bx**2*(1-np.cos(theta_b)))*(cx*cy*(1-np.cos(theta_c))+cz*np.sin(theta_c))*(dx*dy*(1-np.cos(theta_d))-dz*np.sin(theta_d))+(ax*ay*(1-np.cos(theta_a))+az*np.sin(theta_a))*(bx*by*(1-np.cos(theta_b))-bz*np.sin(theta_b))*(cx*cy*(1-np.cos(theta_c))+cz*np.sin(theta_c))*(dx*dy*(1-np.cos(theta_d))-dz*np.sin(theta_d))+(ax*az*(1-np.cos(theta_a))-ay*np.sin(theta_a))*(bx*bz*(1-np.cos(theta_b))+by*np.sin(theta_b))*(cx*cy*(1-np.cos(theta_c))+cz*np.sin(theta_c))*(dx*dy*(1-np.cos(theta_d))-dz*np.sin(theta_d))+(np.cos(theta_a)+ax**2*(1-np.cos(theta_a)))*(bx*by*(1-np.cos(theta_b))+bz*np.sin(theta_b))*(np.cos(theta_c)+cy**2*(1-np.cos(theta_c)))*(dx*dy*(1-np.cos(theta_d))-dz*np.sin(theta_d))+(ax*ay*(1-np.cos(theta_a))+az*np.sin(theta_a))*(np.cos(theta_b)+by**2*(1-np.cos(theta_b)))*(np.cos(theta_c)+cy**2*(1-np.cos(theta_c)))*(dx*dy*(1-np.cos(theta_d))-dz*np.sin(theta_d))+(ax*az*(1-np.cos(theta_a))-ay*np.sin(theta_a))*(by*bz*(1-np.cos(theta_b))-bx*np.sin(theta_b))*(np.cos(theta_c)+cy**2*(1-np.cos(theta_c)))*(dx*dy*(1-np.cos(theta_d))-dz*np.sin(theta_d))+(np.cos(theta_a)+ax**2*(1-np.cos(theta_a)))*(bx*bz*(1-np.cos(theta_b))-by*np.sin(theta_b))*(cy*cz*(1-np.cos(theta_c))-cx*np.sin(theta_c))*(dx*dy*(1-np.cos(theta_d))-dz*np.sin(theta_d))+(ax*ay*(1-np.cos(theta_a))+az*np.sin(theta_a))*(by*bz*(1-np.cos(theta_b))+bx*np.sin(theta_b))*(cy*cz*(1-np.cos(theta_c))-cx*np.sin(theta_c))*(dx*dy*(1-np.cos(theta_d))-dz*np.sin(theta_d))+(ax*az*(1-np.cos(theta_a))-ay*np.sin(theta_a))*(np.cos(theta_b)+bz**2*(1-np.cos(theta_b)))*(cy*cz*(1-np.cos(theta_c))-cx*np.sin(theta_c))*(dx*dy*(1-np.cos(theta_d))-dz*np.sin(theta_d))+(np.cos(theta_a)+ax**2*(1-np.cos(theta_a)))*(np.cos(theta_b)+bx**2*(1-np.cos(theta_b)))*(cx*cz*(1-np.cos(theta_c))-cy*np.sin(theta_c))*(dx*dz*(1-np.cos(theta_d))+dy*np.sin(theta_d))+(ax*ay*(1-np.cos(theta_a))+az*np.sin(theta_a))*(bx*by*(1-np.cos(theta_b))-bz*np.sin(theta_b))*(cx*cz*(1-np.cos(theta_c))-cy*np.sin(theta_c))*(dx*dz*(1-np.cos(theta_d))+dy*np.sin(theta_d))+(ax*az*(1-np.cos(theta_a))-ay*np.sin(theta_a))*(bx*bz*(1-np.cos(theta_b))+by*np.sin(theta_b))*(cx*cz*(1-np.cos(theta_c))-cy*np.sin(theta_c))*(dx*dz*(1-np.cos(theta_d))+dy*np.sin(theta_d))+(np.cos(theta_a)+ax**2*(1-np.cos(theta_a)))*(bx*by*(1-np.cos(theta_b))+bz*np.sin(theta_b))*(cy*cz*(1-np.cos(theta_c))+cx*np.sin(theta_c))*(dx*dz*(1-np.cos(theta_d))+dy*np.sin(theta_d))+(ax*ay*(1-np.cos(theta_a))+az*np.sin(theta_a))*(np.cos(theta_b)+by**2*(1-np.cos(theta_b)))*(cy*cz*(1-np.cos(theta_c))+cx*np.sin(theta_c))*(dx*dz*(1-np.cos(theta_d))+dy*np.sin(theta_d))+(ax*az*(1-np.cos(theta_a))-ay*np.sin(theta_a))*(by*bz*(1-np.cos(theta_b))-bx*np.sin(theta_b))*(cy*cz*(1-np.cos(theta_c))+cx*np.sin(theta_c))*(dx*dz*(1-np.cos(theta_d))+dy*np.sin(theta_d))+(np.cos(theta_a)+ax**2*(1-np.cos(theta_a)))*(bx*bz*(1-np.cos(theta_b))-by*np.sin(theta_b))*(np.cos(theta_c)+cz**2*(1-np.cos(theta_c)))*(dx*dz*(1-np.cos(theta_d))+dy*np.sin(theta_d))+(ax*ay*(1-np.cos(theta_a))+az*np.sin(theta_a))*(by*bz*(1-np.cos(theta_b))+bx*np.sin(theta_b))*(np.cos(theta_c)+cz**2*(1-np.cos(theta_c)))*(dx*dz*(1-np.cos(theta_d))+dy*np.sin(theta_d))+(ax*az*(1-np.cos(theta_a))-ay*np.sin(theta_a))*(np.cos(theta_b)+bz**2*(1-np.cos(theta_b)))*(np.cos(theta_c)+cz**2*(1-np.cos(theta_c)))*(dx*dz*(1-np.cos(theta_d))+dy*np.sin(theta_d))
	R[0,1] = (ax*ay*(1-np.cos(theta_a))-az*np.sin(theta_a))*(np.cos(theta_b)+bx**2*(1-np.cos(theta_b)))*(np.cos(theta_c)+cx**2*(1-np.cos(theta_c)))*(np.cos(theta_d)+dx**2*(1-np.cos(theta_d)))+(np.cos(theta_a)+ay**2*(1-np.cos(theta_a)))*(bx*by*(1-np.cos(theta_b))-bz*np.sin(theta_b))*(np.cos(theta_c)+cx**2*(1-np.cos(theta_c)))*(np.cos(theta_d)+dx**2*(1-np.cos(theta_d)))+(ay*az*(1-np.cos(theta_a))+ax*np.sin(theta_a))*(bx*bz*(1-np.cos(theta_b))+by*np.sin(theta_b))*(np.cos(theta_c)+cx**2*(1-np.cos(theta_c)))*(np.cos(theta_d)+dx**2*(1-np.cos(theta_d)))+(ax*ay*(1-np.cos(theta_a))-az*np.sin(theta_a))*(bx*by*(1-np.cos(theta_b))+bz*np.sin(theta_b))*(cx*cy*(1-np.cos(theta_c))-cz*np.sin(theta_c))*(np.cos(theta_d)+dx**2*(1-np.cos(theta_d)))+(np.cos(theta_a)+ay**2*(1-np.cos(theta_a)))*(np.cos(theta_b)+by**2*(1-np.cos(theta_b)))*(cx*cy*(1-np.cos(theta_c))-cz*np.sin(theta_c))*(np.cos(theta_d)+dx**2*(1-np.cos(theta_d)))+(ay*az*(1-np.cos(theta_a))+ax*np.sin(theta_a))*(by*bz*(1-np.cos(theta_b))-bx*np.sin(theta_b))*(cx*cy*(1-np.cos(theta_c))-cz*np.sin(theta_c))*(np.cos(theta_d)+dx**2*(1-np.cos(theta_d)))+(ax*ay*(1-np.cos(theta_a))-az*np.sin(theta_a))*(bx*bz*(1-np.cos(theta_b))-by*np.sin(theta_b))*(cx*cz*(1-np.cos(theta_c))+cy*np.sin(theta_c))*(np.cos(theta_d)+dx**2*(1-np.cos(theta_d)))+(np.cos(theta_a)+ay**2*(1-np.cos(theta_a)))*(by*bz*(1-np.cos(theta_b))+bx*np.sin(theta_b))*(cx*cz*(1-np.cos(theta_c))+cy*np.sin(theta_c))*(np.cos(theta_d)+dx**2*(1-np.cos(theta_d)))+(ay*az*(1-np.cos(theta_a))+ax*np.sin(theta_a))*(np.cos(theta_b)+bz**2*(1-np.cos(theta_b)))*(cx*cz*(1-np.cos(theta_c))+cy*np.sin(theta_c))*(np.cos(theta_d)+dx**2*(1-np.cos(theta_d)))+(ax*ay*(1-np.cos(theta_a))-az*np.sin(theta_a))*(np.cos(theta_b)+bx**2*(1-np.cos(theta_b)))*(cx*cy*(1-np.cos(theta_c))+cz*np.sin(theta_c))*(dx*dy*(1-np.cos(theta_d))-dz*np.sin(theta_d))+(np.cos(theta_a)+ay**2*(1-np.cos(theta_a)))*(bx*by*(1-np.cos(theta_b))-bz*np.sin(theta_b))*(cx*cy*(1-np.cos(theta_c))+cz*np.sin(theta_c))*(dx*dy*(1-np.cos(theta_d))-dz*np.sin(theta_d))+(ay*az*(1-np.cos(theta_a))+ax*np.sin(theta_a))*(bx*bz*(1-np.cos(theta_b))+by*np.sin(theta_b))*(cx*cy*(1-np.cos(theta_c))+cz*np.sin(theta_c))*(dx*dy*(1-np.cos(theta_d))-dz*np.sin(theta_d))+(ax*ay*(1-np.cos(theta_a))-az*np.sin(theta_a))*(bx*by*(1-np.cos(theta_b))+bz*np.sin(theta_b))*(np.cos(theta_c)+cy**2*(1-np.cos(theta_c)))*(dx*dy*(1-np.cos(theta_d))-dz*np.sin(theta_d))+(np.cos(theta_a)+ay**2*(1-np.cos(theta_a)))*(np.cos(theta_b)+by**2*(1-np.cos(theta_b)))*(np.cos(theta_c)+cy**2*(1-np.cos(theta_c)))*(dx*dy*(1-np.cos(theta_d))-dz*np.sin(theta_d))+(ay*az*(1-np.cos(theta_a))+ax*np.sin(theta_a))*(by*bz*(1-np.cos(theta_b))-bx*np.sin(theta_b))*(np.cos(theta_c)+cy**2*(1-np.cos(theta_c)))*(dx*dy*(1-np.cos(theta_d))-dz*np.sin(theta_d))+(ax*ay*(1-np.cos(theta_a))-az*np.sin(theta_a))*(bx*bz*(1-np.cos(theta_b))-by*np.sin(theta_b))*(cy*cz*(1-np.cos(theta_c))-cx*np.sin(theta_c))*(dx*dy*(1-np.cos(theta_d))-dz*np.sin(theta_d))+(np.cos(theta_a)+ay**2*(1-np.cos(theta_a)))*(by*bz*(1-np.cos(theta_b))+bx*np.sin(theta_b))*(cy*cz*(1-np.cos(theta_c))-cx*np.sin(theta_c))*(dx*dy*(1-np.cos(theta_d))-dz*np.sin(theta_d))+(ay*az*(1-np.cos(theta_a))+ax*np.sin(theta_a))*(np.cos(theta_b)+bz**2*(1-np.cos(theta_b)))*(cy*cz*(1-np.cos(theta_c))-cx*np.sin(theta_c))*(dx*dy*(1-np.cos(theta_d))-dz*np.sin(theta_d))+(ax*ay*(1-np.cos(theta_a))-az*np.sin(theta_a))*(np.cos(theta_b)+bx**2*(1-np.cos(theta_b)))*(cx*cz*(1-np.cos(theta_c))-cy*np.sin(theta_c))*(dx*dz*(1-np.cos(theta_d))+dy*np.sin(theta_d))+(np.cos(theta_a)+ay**2*(1-np.cos(theta_a)))*(bx*by*(1-np.cos(theta_b))-bz*np.sin(theta_b))*(cx*cz*(1-np.cos(theta_c))-cy*np.sin(theta_c))*(dx*dz*(1-np.cos(theta_d))+dy*np.sin(theta_d))+(ay*az*(1-np.cos(theta_a))+ax*np.sin(theta_a))*(bx*bz*(1-np.cos(theta_b))+by*np.sin(theta_b))*(cx*cz*(1-np.cos(theta_c))-cy*np.sin(theta_c))*(dx*dz*(1-np.cos(theta_d))+dy*np.sin(theta_d))+(ax*ay*(1-np.cos(theta_a))-az*np.sin(theta_a))*(bx*by*(1-np.cos(theta_b))+bz*np.sin(theta_b))*(cy*cz*(1-np.cos(theta_c))+cx*np.sin(theta_c))*(dx*dz*(1-np.cos(theta_d))+dy*np.sin(theta_d))+(np.cos(theta_a)+ay**2*(1-np.cos(theta_a)))*(np.cos(theta_b)+by**2*(1-np.cos(theta_b)))*(cy*cz*(1-np.cos(theta_c))+cx*np.sin(theta_c))*(dx*dz*(1-np.cos(theta_d))+dy*np.sin(theta_d))+(ay*az*(1-np.cos(theta_a))+ax*np.sin(theta_a))*(by*bz*(1-np.cos(theta_b))-bx*np.sin(theta_b))*(cy*cz*(1-np.cos(theta_c))+cx*np.sin(theta_c))*(dx*dz*(1-np.cos(theta_d))+dy*np.sin(theta_d))+(ax*ay*(1-np.cos(theta_a))-az*np.sin(theta_a))*(bx*bz*(1-np.cos(theta_b))-by*np.sin(theta_b))*(np.cos(theta_c)+cz**2*(1-np.cos(theta_c)))*(dx*dz*(1-np.cos(theta_d))+dy*np.sin(theta_d))+(np.cos(theta_a)+ay**2*(1-np.cos(theta_a)))*(by*bz*(1-np.cos(theta_b))+bx*np.sin(theta_b))*(np.cos(theta_c)+cz**2*(1-np.cos(theta_c)))*(dx*dz*(1-np.cos(theta_d))+dy*np.sin(theta_d))+(ay*az*(1-np.cos(theta_a))+ax*np.sin(theta_a))*(np.cos(theta_b)+bz**2*(1-np.cos(theta_b)))*(np.cos(theta_c)+cz**2*(1-np.cos(theta_c)))*(dx*dz*(1-np.cos(theta_d))+dy*np.sin(theta_d))
	R[0,2] = (ax*az*(1-np.cos(theta_a))+ay*np.sin(theta_a))*(np.cos(theta_b)+bx**2*(1-np.cos(theta_b)))*(np.cos(theta_c)+cx**2*(1-np.cos(theta_c)))*(np.cos(theta_d)+dx**2*(1-np.cos(theta_d)))+(ay*az*(1-np.cos(theta_a))-ax*np.sin(theta_a))*(bx*by*(1-np.cos(theta_b))-bz*np.sin(theta_b))*(np.cos(theta_c)+cx**2*(1-np.cos(theta_c)))*(np.cos(theta_d)+dx**2*(1-np.cos(theta_d)))+(np.cos(theta_a)+az**2*(1-np.cos(theta_a)))*(bx*bz*(1-np.cos(theta_b))+by*np.sin(theta_b))*(np.cos(theta_c)+cx**2*(1-np.cos(theta_c)))*(np.cos(theta_d)+dx**2*(1-np.cos(theta_d)))+(ax*az*(1-np.cos(theta_a))+ay*np.sin(theta_a))*(bx*by*(1-np.cos(theta_b))+bz*np.sin(theta_b))*(cx*cy*(1-np.cos(theta_c))-cz*np.sin(theta_c))*(np.cos(theta_d)+dx**2*(1-np.cos(theta_d)))+(ay*az*(1-np.cos(theta_a))-ax*np.sin(theta_a))*(np.cos(theta_b)+by**2*(1-np.cos(theta_b)))*(cx*cy*(1-np.cos(theta_c))-cz*np.sin(theta_c))*(np.cos(theta_d)+dx**2*(1-np.cos(theta_d)))+(np.cos(theta_a)+az**2*(1-np.cos(theta_a)))*(by*bz*(1-np.cos(theta_b))-bx*np.sin(theta_b))*(cx*cy*(1-np.cos(theta_c))-cz*np.sin(theta_c))*(np.cos(theta_d)+dx**2*(1-np.cos(theta_d)))+(ax*az*(1-np.cos(theta_a))+ay*np.sin(theta_a))*(bx*bz*(1-np.cos(theta_b))-by*np.sin(theta_b))*(cx*cz*(1-np.cos(theta_c))+cy*np.sin(theta_c))*(np.cos(theta_d)+dx**2*(1-np.cos(theta_d)))+(ay*az*(1-np.cos(theta_a))-ax*np.sin(theta_a))*(by*bz*(1-np.cos(theta_b))+bx*np.sin(theta_b))*(cx*cz*(1-np.cos(theta_c))+cy*np.sin(theta_c))*(np.cos(theta_d)+dx**2*(1-np.cos(theta_d)))+(np.cos(theta_a)+az**2*(1-np.cos(theta_a)))*(np.cos(theta_b)+bz**2*(1-np.cos(theta_b)))*(cx*cz*(1-np.cos(theta_c))+cy*np.sin(theta_c))*(np.cos(theta_d)+dx**2*(1-np.cos(theta_d)))+(ax*az*(1-np.cos(theta_a))+ay*np.sin(theta_a))*(np.cos(theta_b)+bx**2*(1-np.cos(theta_b)))*(cx*cy*(1-np.cos(theta_c))+cz*np.sin(theta_c))*(dx*dy*(1-np.cos(theta_d))-dz*np.sin(theta_d))+(ay*az*(1-np.cos(theta_a))-ax*np.sin(theta_a))*(bx*by*(1-np.cos(theta_b))-bz*np.sin(theta_b))*(cx*cy*(1-np.cos(theta_c))+cz*np.sin(theta_c))*(dx*dy*(1-np.cos(theta_d))-dz*np.sin(theta_d))+(np.cos(theta_a)+az**2*(1-np.cos(theta_a)))*(bx*bz*(1-np.cos(theta_b))+by*np.sin(theta_b))*(cx*cy*(1-np.cos(theta_c))+cz*np.sin(theta_c))*(dx*dy*(1-np.cos(theta_d))-dz*np.sin(theta_d))+(ax*az*(1-np.cos(theta_a))+ay*np.sin(theta_a))*(bx*by*(1-np.cos(theta_b))+bz*np.sin(theta_b))*(np.cos(theta_c)+cy**2*(1-np.cos(theta_c)))*(dx*dy*(1-np.cos(theta_d))-dz*np.sin(theta_d))+(ay*az*(1-np.cos(theta_a))-ax*np.sin(theta_a))*(np.cos(theta_b)+by**2*(1-np.cos(theta_b)))*(np.cos(theta_c)+cy**2*(1-np.cos(theta_c)))*(dx*dy*(1-np.cos(theta_d))-dz*np.sin(theta_d))+(np.cos(theta_a)+az**2*(1-np.cos(theta_a)))*(by*bz*(1-np.cos(theta_b))-bx*np.sin(theta_b))*(np.cos(theta_c)+cy**2*(1-np.cos(theta_c)))*(dx*dy*(1-np.cos(theta_d))-dz*np.sin(theta_d))+(ax*az*(1-np.cos(theta_a))+ay*np.sin(theta_a))*(bx*bz*(1-np.cos(theta_b))-by*np.sin(theta_b))*(cy*cz*(1-np.cos(theta_c))-cx*np.sin(theta_c))*(dx*dy*(1-np.cos(theta_d))-dz*np.sin(theta_d))+(ay*az*(1-np.cos(theta_a))-ax*np.sin(theta_a))*(by*bz*(1-np.cos(theta_b))+bx*np.sin(theta_b))*(cy*cz*(1-np.cos(theta_c))-cx*np.sin(theta_c))*(dx*dy*(1-np.cos(theta_d))-dz*np.sin(theta_d))+(np.cos(theta_a)+az**2*(1-np.cos(theta_a)))*(np.cos(theta_b)+bz**2*(1-np.cos(theta_b)))*(cy*cz*(1-np.cos(theta_c))-cx*np.sin(theta_c))*(dx*dy*(1-np.cos(theta_d))-dz*np.sin(theta_d))+(ax*az*(1-np.cos(theta_a))+ay*np.sin(theta_a))*(np.cos(theta_b)+bx**2*(1-np.cos(theta_b)))*(cx*cz*(1-np.cos(theta_c))-cy*np.sin(theta_c))*(dx*dz*(1-np.cos(theta_d))+dy*np.sin(theta_d))+(ay*az*(1-np.cos(theta_a))-ax*np.sin(theta_a))*(bx*by*(1-np.cos(theta_b))-bz*np.sin(theta_b))*(cx*cz*(1-np.cos(theta_c))-cy*np.sin(theta_c))*(dx*dz*(1-np.cos(theta_d))+dy*np.sin(theta_d))+(np.cos(theta_a)+az**2*(1-np.cos(theta_a)))*(bx*bz*(1-np.cos(theta_b))+by*np.sin(theta_b))*(cx*cz*(1-np.cos(theta_c))-cy*np.sin(theta_c))*(dx*dz*(1-np.cos(theta_d))+dy*np.sin(theta_d))+(ax*az*(1-np.cos(theta_a))+ay*np.sin(theta_a))*(bx*by*(1-np.cos(theta_b))+bz*np.sin(theta_b))*(cy*cz*(1-np.cos(theta_c))+cx*np.sin(theta_c))*(dx*dz*(1-np.cos(theta_d))+dy*np.sin(theta_d))+(ay*az*(1-np.cos(theta_a))-ax*np.sin(theta_a))*(np.cos(theta_b)+by**2*(1-np.cos(theta_b)))*(cy*cz*(1-np.cos(theta_c))+cx*np.sin(theta_c))*(dx*dz*(1-np.cos(theta_d))+dy*np.sin(theta_d))+(np.cos(theta_a)+az**2*(1-np.cos(theta_a)))*(by*bz*(1-np.cos(theta_b))-bx*np.sin(theta_b))*(cy*cz*(1-np.cos(theta_c))+cx*np.sin(theta_c))*(dx*dz*(1-np.cos(theta_d))+dy*np.sin(theta_d))+(ax*az*(1-np.cos(theta_a))+ay*np.sin(theta_a))*(bx*bz*(1-np.cos(theta_b))-by*np.sin(theta_b))*(np.cos(theta_c)+cz**2*(1-np.cos(theta_c)))*(dx*dz*(1-np.cos(theta_d))+dy*np.sin(theta_d))+(ay*az*(1-np.cos(theta_a))-ax*np.sin(theta_a))*(by*bz*(1-np.cos(theta_b))+bx*np.sin(theta_b))*(np.cos(theta_c)+cz**2*(1-np.cos(theta_c)))*(dx*dz*(1-np.cos(theta_d))+dy*np.sin(theta_d))+(np.cos(theta_a)+az**2*(1-np.cos(theta_a)))*(np.cos(theta_b)+bz**2*(1-np.cos(theta_b)))*(np.cos(theta_c)+cz**2*(1-np.cos(theta_c)))*(dx*dz*(1-np.cos(theta_d))+dy*np.sin(theta_d))
	R[1,0] = (np.cos(theta_a)+ax**2*(1-np.cos(theta_a)))*(np.cos(theta_b)+bx**2*(1-np.cos(theta_b)))*(np.cos(theta_c)+cx**2*(1-np.cos(theta_c)))*(dx*dy*(1-np.cos(theta_d))+dz*np.sin(theta_d))+(ax*ay*(1-np.cos(theta_a))+az*np.sin(theta_a))*(bx*by*(1-np.cos(theta_b))-bz*np.sin(theta_b))*(np.cos(theta_c)+cx**2*(1-np.cos(theta_c)))*(dx*dy*(1-np.cos(theta_d))+dz*np.sin(theta_d))+(ax*az*(1-np.cos(theta_a))-ay*np.sin(theta_a))*(bx*bz*(1-np.cos(theta_b))+by*np.sin(theta_b))*(np.cos(theta_c)+cx**2*(1-np.cos(theta_c)))*(dx*dy*(1-np.cos(theta_d))+dz*np.sin(theta_d))+(np.cos(theta_a)+ax**2*(1-np.cos(theta_a)))*(bx*by*(1-np.cos(theta_b))+bz*np.sin(theta_b))*(cx*cy*(1-np.cos(theta_c))-cz*np.sin(theta_c))*(dx*dy*(1-np.cos(theta_d))+dz*np.sin(theta_d))+(ax*ay*(1-np.cos(theta_a))+az*np.sin(theta_a))*(np.cos(theta_b)+by**2*(1-np.cos(theta_b)))*(cx*cy*(1-np.cos(theta_c))-cz*np.sin(theta_c))*(dx*dy*(1-np.cos(theta_d))+dz*np.sin(theta_d))+(ax*az*(1-np.cos(theta_a))-ay*np.sin(theta_a))*(by*bz*(1-np.cos(theta_b))-bx*np.sin(theta_b))*(cx*cy*(1-np.cos(theta_c))-cz*np.sin(theta_c))*(dx*dy*(1-np.cos(theta_d))+dz*np.sin(theta_d))+(np.cos(theta_a)+ax**2*(1-np.cos(theta_a)))*(bx*bz*(1-np.cos(theta_b))-by*np.sin(theta_b))*(cx*cz*(1-np.cos(theta_c))+cy*np.sin(theta_c))*(dx*dy*(1-np.cos(theta_d))+dz*np.sin(theta_d))+(ax*ay*(1-np.cos(theta_a))+az*np.sin(theta_a))*(by*bz*(1-np.cos(theta_b))+bx*np.sin(theta_b))*(cx*cz*(1-np.cos(theta_c))+cy*np.sin(theta_c))*(dx*dy*(1-np.cos(theta_d))+dz*np.sin(theta_d))+(ax*az*(1-np.cos(theta_a))-ay*np.sin(theta_a))*(np.cos(theta_b)+bz**2*(1-np.cos(theta_b)))*(cx*cz*(1-np.cos(theta_c))+cy*np.sin(theta_c))*(dx*dy*(1-np.cos(theta_d))+dz*np.sin(theta_d))+(np.cos(theta_a)+ax**2*(1-np.cos(theta_a)))*(np.cos(theta_b)+bx**2*(1-np.cos(theta_b)))*(cx*cy*(1-np.cos(theta_c))+cz*np.sin(theta_c))*(np.cos(theta_d)+dy**2*(1-np.cos(theta_d)))+(ax*ay*(1-np.cos(theta_a))+az*np.sin(theta_a))*(bx*by*(1-np.cos(theta_b))-bz*np.sin(theta_b))*(cx*cy*(1-np.cos(theta_c))+cz*np.sin(theta_c))*(np.cos(theta_d)+dy**2*(1-np.cos(theta_d)))+(ax*az*(1-np.cos(theta_a))-ay*np.sin(theta_a))*(bx*bz*(1-np.cos(theta_b))+by*np.sin(theta_b))*(cx*cy*(1-np.cos(theta_c))+cz*np.sin(theta_c))*(np.cos(theta_d)+dy**2*(1-np.cos(theta_d)))+(np.cos(theta_a)+ax**2*(1-np.cos(theta_a)))*(bx*by*(1-np.cos(theta_b))+bz*np.sin(theta_b))*(np.cos(theta_c)+cy**2*(1-np.cos(theta_c)))*(np.cos(theta_d)+dy**2*(1-np.cos(theta_d)))+(ax*ay*(1-np.cos(theta_a))+az*np.sin(theta_a))*(np.cos(theta_b)+by**2*(1-np.cos(theta_b)))*(np.cos(theta_c)+cy**2*(1-np.cos(theta_c)))*(np.cos(theta_d)+dy**2*(1-np.cos(theta_d)))+(ax*az*(1-np.cos(theta_a))-ay*np.sin(theta_a))*(by*bz*(1-np.cos(theta_b))-bx*np.sin(theta_b))*(np.cos(theta_c)+cy**2*(1-np.cos(theta_c)))*(np.cos(theta_d)+dy**2*(1-np.cos(theta_d)))+(np.cos(theta_a)+ax**2*(1-np.cos(theta_a)))*(bx*bz*(1-np.cos(theta_b))-by*np.sin(theta_b))*(cy*cz*(1-np.cos(theta_c))-cx*np.sin(theta_c))*(np.cos(theta_d)+dy**2*(1-np.cos(theta_d)))+(ax*ay*(1-np.cos(theta_a))+az*np.sin(theta_a))*(by*bz*(1-np.cos(theta_b))+bx*np.sin(theta_b))*(cy*cz*(1-np.cos(theta_c))-cx*np.sin(theta_c))*(np.cos(theta_d)+dy**2*(1-np.cos(theta_d)))+(ax*az*(1-np.cos(theta_a))-ay*np.sin(theta_a))*(np.cos(theta_b)+bz**2*(1-np.cos(theta_b)))*(cy*cz*(1-np.cos(theta_c))-cx*np.sin(theta_c))*(np.cos(theta_d)+dy**2*(1-np.cos(theta_d)))+(np.cos(theta_a)+ax**2*(1-np.cos(theta_a)))*(np.cos(theta_b)+bx**2*(1-np.cos(theta_b)))*(cx*cz*(1-np.cos(theta_c))-cy*np.sin(theta_c))*(dy*dz*(1-np.cos(theta_d))-dx*np.sin(theta_d))+(ax*ay*(1-np.cos(theta_a))+az*np.sin(theta_a))*(bx*by*(1-np.cos(theta_b))-bz*np.sin(theta_b))*(cx*cz*(1-np.cos(theta_c))-cy*np.sin(theta_c))*(dy*dz*(1-np.cos(theta_d))-dx*np.sin(theta_d))+(ax*az*(1-np.cos(theta_a))-ay*np.sin(theta_a))*(bx*bz*(1-np.cos(theta_b))+by*np.sin(theta_b))*(cx*cz*(1-np.cos(theta_c))-cy*np.sin(theta_c))*(dy*dz*(1-np.cos(theta_d))-dx*np.sin(theta_d))+(np.cos(theta_a)+ax**2*(1-np.cos(theta_a)))*(bx*by*(1-np.cos(theta_b))+bz*np.sin(theta_b))*(cy*cz*(1-np.cos(theta_c))+cx*np.sin(theta_c))*(dy*dz*(1-np.cos(theta_d))-dx*np.sin(theta_d))+(ax*ay*(1-np.cos(theta_a))+az*np.sin(theta_a))*(np.cos(theta_b)+by**2*(1-np.cos(theta_b)))*(cy*cz*(1-np.cos(theta_c))+cx*np.sin(theta_c))*(dy*dz*(1-np.cos(theta_d))-dx*np.sin(theta_d))+(ax*az*(1-np.cos(theta_a))-ay*np.sin(theta_a))*(by*bz*(1-np.cos(theta_b))-bx*np.sin(theta_b))*(cy*cz*(1-np.cos(theta_c))+cx*np.sin(theta_c))*(dy*dz*(1-np.cos(theta_d))-dx*np.sin(theta_d))+(np.cos(theta_a)+ax**2*(1-np.cos(theta_a)))*(bx*bz*(1-np.cos(theta_b))-by*np.sin(theta_b))*(np.cos(theta_c)+cz**2*(1-np.cos(theta_c)))*(dy*dz*(1-np.cos(theta_d))-dx*np.sin(theta_d))+(ax*ay*(1-np.cos(theta_a))+az*np.sin(theta_a))*(by*bz*(1-np.cos(theta_b))+bx*np.sin(theta_b))*(np.cos(theta_c)+cz**2*(1-np.cos(theta_c)))*(dy*dz*(1-np.cos(theta_d))-dx*np.sin(theta_d))+(ax*az*(1-np.cos(theta_a))-ay*np.sin(theta_a))*(np.cos(theta_b)+bz**2*(1-np.cos(theta_b)))*(np.cos(theta_c)+cz**2*(1-np.cos(theta_c)))*(dy*dz*(1-np.cos(theta_d))-dx*np.sin(theta_d))
	R[1,1] = (ax*ay*(1-np.cos(theta_a))-az*np.sin(theta_a))*(np.cos(theta_b)+bx**2*(1-np.cos(theta_b)))*(np.cos(theta_c)+cx**2*(1-np.cos(theta_c)))*(dx*dy*(1-np.cos(theta_d))+dz*np.sin(theta_d))+(np.cos(theta_a)+ay**2*(1-np.cos(theta_a)))*(bx*by*(1-np.cos(theta_b))-bz*np.sin(theta_b))*(np.cos(theta_c)+cx**2*(1-np.cos(theta_c)))*(dx*dy*(1-np.cos(theta_d))+dz*np.sin(theta_d))+(ay*az*(1-np.cos(theta_a))+ax*np.sin(theta_a))*(bx*bz*(1-np.cos(theta_b))+by*np.sin(theta_b))*(np.cos(theta_c)+cx**2*(1-np.cos(theta_c)))*(dx*dy*(1-np.cos(theta_d))+dz*np.sin(theta_d))+(ax*ay*(1-np.cos(theta_a))-az*np.sin(theta_a))*(bx*by*(1-np.cos(theta_b))+bz*np.sin(theta_b))*(cx*cy*(1-np.cos(theta_c))-cz*np.sin(theta_c))*(dx*dy*(1-np.cos(theta_d))+dz*np.sin(theta_d))+(np.cos(theta_a)+ay**2*(1-np.cos(theta_a)))*(np.cos(theta_b)+by**2*(1-np.cos(theta_b)))*(cx*cy*(1-np.cos(theta_c))-cz*np.sin(theta_c))*(dx*dy*(1-np.cos(theta_d))+dz*np.sin(theta_d))+(ay*az*(1-np.cos(theta_a))+ax*np.sin(theta_a))*(by*bz*(1-np.cos(theta_b))-bx*np.sin(theta_b))*(cx*cy*(1-np.cos(theta_c))-cz*np.sin(theta_c))*(dx*dy*(1-np.cos(theta_d))+dz*np.sin(theta_d))+(ax*ay*(1-np.cos(theta_a))-az*np.sin(theta_a))*(bx*bz*(1-np.cos(theta_b))-by*np.sin(theta_b))*(cx*cz*(1-np.cos(theta_c))+cy*np.sin(theta_c))*(dx*dy*(1-np.cos(theta_d))+dz*np.sin(theta_d))+(np.cos(theta_a)+ay**2*(1-np.cos(theta_a)))*(by*bz*(1-np.cos(theta_b))+bx*np.sin(theta_b))*(cx*cz*(1-np.cos(theta_c))+cy*np.sin(theta_c))*(dx*dy*(1-np.cos(theta_d))+dz*np.sin(theta_d))+(ay*az*(1-np.cos(theta_a))+ax*np.sin(theta_a))*(np.cos(theta_b)+bz**2*(1-np.cos(theta_b)))*(cx*cz*(1-np.cos(theta_c))+cy*np.sin(theta_c))*(dx*dy*(1-np.cos(theta_d))+dz*np.sin(theta_d))+(ax*ay*(1-np.cos(theta_a))-az*np.sin(theta_a))*(np.cos(theta_b)+bx**2*(1-np.cos(theta_b)))*(cx*cy*(1-np.cos(theta_c))+cz*np.sin(theta_c))*(np.cos(theta_d)+dy**2*(1-np.cos(theta_d)))+(np.cos(theta_a)+ay**2*(1-np.cos(theta_a)))*(bx*by*(1-np.cos(theta_b))-bz*np.sin(theta_b))*(cx*cy*(1-np.cos(theta_c))+cz*np.sin(theta_c))*(np.cos(theta_d)+dy**2*(1-np.cos(theta_d)))+(ay*az*(1-np.cos(theta_a))+ax*np.sin(theta_a))*(bx*bz*(1-np.cos(theta_b))+by*np.sin(theta_b))*(cx*cy*(1-np.cos(theta_c))+cz*np.sin(theta_c))*(np.cos(theta_d)+dy**2*(1-np.cos(theta_d)))+(ax*ay*(1-np.cos(theta_a))-az*np.sin(theta_a))*(bx*by*(1-np.cos(theta_b))+bz*np.sin(theta_b))*(np.cos(theta_c)+cy**2*(1-np.cos(theta_c)))*(np.cos(theta_d)+dy**2*(1-np.cos(theta_d)))+(np.cos(theta_a)+ay**2*(1-np.cos(theta_a)))*(np.cos(theta_b)+by**2*(1-np.cos(theta_b)))*(np.cos(theta_c)+cy**2*(1-np.cos(theta_c)))*(np.cos(theta_d)+dy**2*(1-np.cos(theta_d)))+(ay*az*(1-np.cos(theta_a))+ax*np.sin(theta_a))*(by*bz*(1-np.cos(theta_b))-bx*np.sin(theta_b))*(np.cos(theta_c)+cy**2*(1-np.cos(theta_c)))*(np.cos(theta_d)+dy**2*(1-np.cos(theta_d)))+(ax*ay*(1-np.cos(theta_a))-az*np.sin(theta_a))*(bx*bz*(1-np.cos(theta_b))-by*np.sin(theta_b))*(cy*cz*(1-np.cos(theta_c))-cx*np.sin(theta_c))*(np.cos(theta_d)+dy**2*(1-np.cos(theta_d)))+(np.cos(theta_a)+ay**2*(1-np.cos(theta_a)))*(by*bz*(1-np.cos(theta_b))+bx*np.sin(theta_b))*(cy*cz*(1-np.cos(theta_c))-cx*np.sin(theta_c))*(np.cos(theta_d)+dy**2*(1-np.cos(theta_d)))+(ay*az*(1-np.cos(theta_a))+ax*np.sin(theta_a))*(np.cos(theta_b)+bz**2*(1-np.cos(theta_b)))*(cy*cz*(1-np.cos(theta_c))-cx*np.sin(theta_c))*(np.cos(theta_d)+dy**2*(1-np.cos(theta_d)))+(ax*ay*(1-np.cos(theta_a))-az*np.sin(theta_a))*(np.cos(theta_b)+bx**2*(1-np.cos(theta_b)))*(cx*cz*(1-np.cos(theta_c))-cy*np.sin(theta_c))*(dy*dz*(1-np.cos(theta_d))-dx*np.sin(theta_d))+(np.cos(theta_a)+ay**2*(1-np.cos(theta_a)))*(bx*by*(1-np.cos(theta_b))-bz*np.sin(theta_b))*(cx*cz*(1-np.cos(theta_c))-cy*np.sin(theta_c))*(dy*dz*(1-np.cos(theta_d))-dx*np.sin(theta_d))+(ay*az*(1-np.cos(theta_a))+ax*np.sin(theta_a))*(bx*bz*(1-np.cos(theta_b))+by*np.sin(theta_b))*(cx*cz*(1-np.cos(theta_c))-cy*np.sin(theta_c))*(dy*dz*(1-np.cos(theta_d))-dx*np.sin(theta_d))+(ax*ay*(1-np.cos(theta_a))-az*np.sin(theta_a))*(bx*by*(1-np.cos(theta_b))+bz*np.sin(theta_b))*(cy*cz*(1-np.cos(theta_c))+cx*np.sin(theta_c))*(dy*dz*(1-np.cos(theta_d))-dx*np.sin(theta_d))+(np.cos(theta_a)+ay**2*(1-np.cos(theta_a)))*(np.cos(theta_b)+by**2*(1-np.cos(theta_b)))*(cy*cz*(1-np.cos(theta_c))+cx*np.sin(theta_c))*(dy*dz*(1-np.cos(theta_d))-dx*np.sin(theta_d))+(ay*az*(1-np.cos(theta_a))+ax*np.sin(theta_a))*(by*bz*(1-np.cos(theta_b))-bx*np.sin(theta_b))*(cy*cz*(1-np.cos(theta_c))+cx*np.sin(theta_c))*(dy*dz*(1-np.cos(theta_d))-dx*np.sin(theta_d))+(ax*ay*(1-np.cos(theta_a))-az*np.sin(theta_a))*(bx*bz*(1-np.cos(theta_b))-by*np.sin(theta_b))*(np.cos(theta_c)+cz**2*(1-np.cos(theta_c)))*(dy*dz*(1-np.cos(theta_d))-dx*np.sin(theta_d))+(np.cos(theta_a)+ay**2*(1-np.cos(theta_a)))*(by*bz*(1-np.cos(theta_b))+bx*np.sin(theta_b))*(np.cos(theta_c)+cz**2*(1-np.cos(theta_c)))*(dy*dz*(1-np.cos(theta_d))-dx*np.sin(theta_d))+(ay*az*(1-np.cos(theta_a))+ax*np.sin(theta_a))*(np.cos(theta_b)+bz**2*(1-np.cos(theta_b)))*(np.cos(theta_c)+cz**2*(1-np.cos(theta_c)))*(dy*dz*(1-np.cos(theta_d))-dx*np.sin(theta_d))
	R[1,2] = (ax*az*(1-np.cos(theta_a))+ay*np.sin(theta_a))*(np.cos(theta_b)+bx**2*(1-np.cos(theta_b)))*(np.cos(theta_c)+cx**2*(1-np.cos(theta_c)))*(dx*dy*(1-np.cos(theta_d))+dz*np.sin(theta_d))+(ay*az*(1-np.cos(theta_a))-ax*np.sin(theta_a))*(bx*by*(1-np.cos(theta_b))-bz*np.sin(theta_b))*(np.cos(theta_c)+cx**2*(1-np.cos(theta_c)))*(dx*dy*(1-np.cos(theta_d))+dz*np.sin(theta_d))+(np.cos(theta_a)+az**2*(1-np.cos(theta_a)))*(bx*bz*(1-np.cos(theta_b))+by*np.sin(theta_b))*(np.cos(theta_c)+cx**2*(1-np.cos(theta_c)))*(dx*dy*(1-np.cos(theta_d))+dz*np.sin(theta_d))+(ax*az*(1-np.cos(theta_a))+ay*np.sin(theta_a))*(bx*by*(1-np.cos(theta_b))+bz*np.sin(theta_b))*(cx*cy*(1-np.cos(theta_c))-cz*np.sin(theta_c))*(dx*dy*(1-np.cos(theta_d))+dz*np.sin(theta_d))+(ay*az*(1-np.cos(theta_a))-ax*np.sin(theta_a))*(np.cos(theta_b)+by**2*(1-np.cos(theta_b)))*(cx*cy*(1-np.cos(theta_c))-cz*np.sin(theta_c))*(dx*dy*(1-np.cos(theta_d))+dz*np.sin(theta_d))+(np.cos(theta_a)+az**2*(1-np.cos(theta_a)))*(by*bz*(1-np.cos(theta_b))-bx*np.sin(theta_b))*(cx*cy*(1-np.cos(theta_c))-cz*np.sin(theta_c))*(dx*dy*(1-np.cos(theta_d))+dz*np.sin(theta_d))+(ax*az*(1-np.cos(theta_a))+ay*np.sin(theta_a))*(bx*bz*(1-np.cos(theta_b))-by*np.sin(theta_b))*(cx*cz*(1-np.cos(theta_c))+cy*np.sin(theta_c))*(dx*dy*(1-np.cos(theta_d))+dz*np.sin(theta_d))+(ay*az*(1-np.cos(theta_a))-ax*np.sin(theta_a))*(by*bz*(1-np.cos(theta_b))+bx*np.sin(theta_b))*(cx*cz*(1-np.cos(theta_c))+cy*np.sin(theta_c))*(dx*dy*(1-np.cos(theta_d))+dz*np.sin(theta_d))+(np.cos(theta_a)+az**2*(1-np.cos(theta_a)))*(np.cos(theta_b)+bz**2*(1-np.cos(theta_b)))*(cx*cz*(1-np.cos(theta_c))+cy*np.sin(theta_c))*(dx*dy*(1-np.cos(theta_d))+dz*np.sin(theta_d))+(ax*az*(1-np.cos(theta_a))+ay*np.sin(theta_a))*(np.cos(theta_b)+bx**2*(1-np.cos(theta_b)))*(cx*cy*(1-np.cos(theta_c))+cz*np.sin(theta_c))*(np.cos(theta_d)+dy**2*(1-np.cos(theta_d)))+(ay*az*(1-np.cos(theta_a))-ax*np.sin(theta_a))*(bx*by*(1-np.cos(theta_b))-bz*np.sin(theta_b))*(cx*cy*(1-np.cos(theta_c))+cz*np.sin(theta_c))*(np.cos(theta_d)+dy**2*(1-np.cos(theta_d)))+(np.cos(theta_a)+az**2*(1-np.cos(theta_a)))*(bx*bz*(1-np.cos(theta_b))+by*np.sin(theta_b))*(cx*cy*(1-np.cos(theta_c))+cz*np.sin(theta_c))*(np.cos(theta_d)+dy**2*(1-np.cos(theta_d)))+(ax*az*(1-np.cos(theta_a))+ay*np.sin(theta_a))*(bx*by*(1-np.cos(theta_b))+bz*np.sin(theta_b))*(np.cos(theta_c)+cy**2*(1-np.cos(theta_c)))*(np.cos(theta_d)+dy**2*(1-np.cos(theta_d)))+(ay*az*(1-np.cos(theta_a))-ax*np.sin(theta_a))*(np.cos(theta_b)+by**2*(1-np.cos(theta_b)))*(np.cos(theta_c)+cy**2*(1-np.cos(theta_c)))*(np.cos(theta_d)+dy**2*(1-np.cos(theta_d)))+(np.cos(theta_a)+az**2*(1-np.cos(theta_a)))*(by*bz*(1-np.cos(theta_b))-bx*np.sin(theta_b))*(np.cos(theta_c)+cy**2*(1-np.cos(theta_c)))*(np.cos(theta_d)+dy**2*(1-np.cos(theta_d)))+(ax*az*(1-np.cos(theta_a))+ay*np.sin(theta_a))*(bx*bz*(1-np.cos(theta_b))-by*np.sin(theta_b))*(cy*cz*(1-np.cos(theta_c))-cx*np.sin(theta_c))*(np.cos(theta_d)+dy**2*(1-np.cos(theta_d)))+(ay*az*(1-np.cos(theta_a))-ax*np.sin(theta_a))*(by*bz*(1-np.cos(theta_b))+bx*np.sin(theta_b))*(cy*cz*(1-np.cos(theta_c))-cx*np.sin(theta_c))*(np.cos(theta_d)+dy**2*(1-np.cos(theta_d)))+(np.cos(theta_a)+az**2*(1-np.cos(theta_a)))*(np.cos(theta_b)+bz**2*(1-np.cos(theta_b)))*(cy*cz*(1-np.cos(theta_c))-cx*np.sin(theta_c))*(np.cos(theta_d)+dy**2*(1-np.cos(theta_d)))+(ax*az*(1-np.cos(theta_a))+ay*np.sin(theta_a))*(np.cos(theta_b)+bx**2*(1-np.cos(theta_b)))*(cx*cz*(1-np.cos(theta_c))-cy*np.sin(theta_c))*(dy*dz*(1-np.cos(theta_d))-dx*np.sin(theta_d))+(ay*az*(1-np.cos(theta_a))-ax*np.sin(theta_a))*(bx*by*(1-np.cos(theta_b))-bz*np.sin(theta_b))*(cx*cz*(1-np.cos(theta_c))-cy*np.sin(theta_c))*(dy*dz*(1-np.cos(theta_d))-dx*np.sin(theta_d))+(np.cos(theta_a)+az**2*(1-np.cos(theta_a)))*(bx*bz*(1-np.cos(theta_b))+by*np.sin(theta_b))*(cx*cz*(1-np.cos(theta_c))-cy*np.sin(theta_c))*(dy*dz*(1-np.cos(theta_d))-dx*np.sin(theta_d))+(ax*az*(1-np.cos(theta_a))+ay*np.sin(theta_a))*(bx*by*(1-np.cos(theta_b))+bz*np.sin(theta_b))*(cy*cz*(1-np.cos(theta_c))+cx*np.sin(theta_c))*(dy*dz*(1-np.cos(theta_d))-dx*np.sin(theta_d))+(ay*az*(1-np.cos(theta_a))-ax*np.sin(theta_a))*(np.cos(theta_b)+by**2*(1-np.cos(theta_b)))*(cy*cz*(1-np.cos(theta_c))+cx*np.sin(theta_c))*(dy*dz*(1-np.cos(theta_d))-dx*np.sin(theta_d))+(np.cos(theta_a)+az**2*(1-np.cos(theta_a)))*(by*bz*(1-np.cos(theta_b))-bx*np.sin(theta_b))*(cy*cz*(1-np.cos(theta_c))+cx*np.sin(theta_c))*(dy*dz*(1-np.cos(theta_d))-dx*np.sin(theta_d))+(ax*az*(1-np.cos(theta_a))+ay*np.sin(theta_a))*(bx*bz*(1-np.cos(theta_b))-by*np.sin(theta_b))*(np.cos(theta_c)+cz**2*(1-np.cos(theta_c)))*(dy*dz*(1-np.cos(theta_d))-dx*np.sin(theta_d))+(ay*az*(1-np.cos(theta_a))-ax*np.sin(theta_a))*(by*bz*(1-np.cos(theta_b))+bx*np.sin(theta_b))*(np.cos(theta_c)+cz**2*(1-np.cos(theta_c)))*(dy*dz*(1-np.cos(theta_d))-dx*np.sin(theta_d))+(np.cos(theta_a)+az**2*(1-np.cos(theta_a)))*(np.cos(theta_b)+bz**2*(1-np.cos(theta_b)))*(np.cos(theta_c)+cz**2*(1-np.cos(theta_c)))*(dy*dz*(1-np.cos(theta_d))-dx*np.sin(theta_d))
	R[2,0] = (np.cos(theta_a)+ax**2*(1-np.cos(theta_a)))*(np.cos(theta_b)+bx**2*(1-np.cos(theta_b)))*(np.cos(theta_c)+cx**2*(1-np.cos(theta_c)))*(dx*dz*(1-np.cos(theta_d))-dy*np.sin(theta_d))+(ax*ay*(1-np.cos(theta_a))+az*np.sin(theta_a))*(bx*by*(1-np.cos(theta_b))-bz*np.sin(theta_b))*(np.cos(theta_c)+cx**2*(1-np.cos(theta_c)))*(dx*dz*(1-np.cos(theta_d))-dy*np.sin(theta_d))+(ax*az*(1-np.cos(theta_a))-ay*np.sin(theta_a))*(bx*bz*(1-np.cos(theta_b))+by*np.sin(theta_b))*(np.cos(theta_c)+cx**2*(1-np.cos(theta_c)))*(dx*dz*(1-np.cos(theta_d))-dy*np.sin(theta_d))+(np.cos(theta_a)+ax**2*(1-np.cos(theta_a)))*(bx*by*(1-np.cos(theta_b))+bz*np.sin(theta_b))*(cx*cy*(1-np.cos(theta_c))-cz*np.sin(theta_c))*(dx*dz*(1-np.cos(theta_d))-dy*np.sin(theta_d))+(ax*ay*(1-np.cos(theta_a))+az*np.sin(theta_a))*(np.cos(theta_b)+by**2*(1-np.cos(theta_b)))*(cx*cy*(1-np.cos(theta_c))-cz*np.sin(theta_c))*(dx*dz*(1-np.cos(theta_d))-dy*np.sin(theta_d))+(ax*az*(1-np.cos(theta_a))-ay*np.sin(theta_a))*(by*bz*(1-np.cos(theta_b))-bx*np.sin(theta_b))*(cx*cy*(1-np.cos(theta_c))-cz*np.sin(theta_c))*(dx*dz*(1-np.cos(theta_d))-dy*np.sin(theta_d))+(np.cos(theta_a)+ax**2*(1-np.cos(theta_a)))*(bx*bz*(1-np.cos(theta_b))-by*np.sin(theta_b))*(cx*cz*(1-np.cos(theta_c))+cy*np.sin(theta_c))*(dx*dz*(1-np.cos(theta_d))-dy*np.sin(theta_d))+(ax*ay*(1-np.cos(theta_a))+az*np.sin(theta_a))*(by*bz*(1-np.cos(theta_b))+bx*np.sin(theta_b))*(cx*cz*(1-np.cos(theta_c))+cy*np.sin(theta_c))*(dx*dz*(1-np.cos(theta_d))-dy*np.sin(theta_d))+(ax*az*(1-np.cos(theta_a))-ay*np.sin(theta_a))*(np.cos(theta_b)+bz**2*(1-np.cos(theta_b)))*(cx*cz*(1-np.cos(theta_c))+cy*np.sin(theta_c))*(dx*dz*(1-np.cos(theta_d))-dy*np.sin(theta_d))+(np.cos(theta_a)+ax**2*(1-np.cos(theta_a)))*(np.cos(theta_b)+bx**2*(1-np.cos(theta_b)))*(cx*cy*(1-np.cos(theta_c))+cz*np.sin(theta_c))*(dy*dz*(1-np.cos(theta_d))+dx*np.sin(theta_d))+(ax*ay*(1-np.cos(theta_a))+az*np.sin(theta_a))*(bx*by*(1-np.cos(theta_b))-bz*np.sin(theta_b))*(cx*cy*(1-np.cos(theta_c))+cz*np.sin(theta_c))*(dy*dz*(1-np.cos(theta_d))+dx*np.sin(theta_d))+(ax*az*(1-np.cos(theta_a))-ay*np.sin(theta_a))*(bx*bz*(1-np.cos(theta_b))+by*np.sin(theta_b))*(cx*cy*(1-np.cos(theta_c))+cz*np.sin(theta_c))*(dy*dz*(1-np.cos(theta_d))+dx*np.sin(theta_d))+(np.cos(theta_a)+ax**2*(1-np.cos(theta_a)))*(bx*by*(1-np.cos(theta_b))+bz*np.sin(theta_b))*(np.cos(theta_c)+cy**2*(1-np.cos(theta_c)))*(dy*dz*(1-np.cos(theta_d))+dx*np.sin(theta_d))+(ax*ay*(1-np.cos(theta_a))+az*np.sin(theta_a))*(np.cos(theta_b)+by**2*(1-np.cos(theta_b)))*(np.cos(theta_c)+cy**2*(1-np.cos(theta_c)))*(dy*dz*(1-np.cos(theta_d))+dx*np.sin(theta_d))+(ax*az*(1-np.cos(theta_a))-ay*np.sin(theta_a))*(by*bz*(1-np.cos(theta_b))-bx*np.sin(theta_b))*(np.cos(theta_c)+cy**2*(1-np.cos(theta_c)))*(dy*dz*(1-np.cos(theta_d))+dx*np.sin(theta_d))+(np.cos(theta_a)+ax**2*(1-np.cos(theta_a)))*(bx*bz*(1-np.cos(theta_b))-by*np.sin(theta_b))*(cy*cz*(1-np.cos(theta_c))-cx*np.sin(theta_c))*(dy*dz*(1-np.cos(theta_d))+dx*np.sin(theta_d))+(ax*ay*(1-np.cos(theta_a))+az*np.sin(theta_a))*(by*bz*(1-np.cos(theta_b))+bx*np.sin(theta_b))*(cy*cz*(1-np.cos(theta_c))-cx*np.sin(theta_c))*(dy*dz*(1-np.cos(theta_d))+dx*np.sin(theta_d))+(ax*az*(1-np.cos(theta_a))-ay*np.sin(theta_a))*(np.cos(theta_b)+bz**2*(1-np.cos(theta_b)))*(cy*cz*(1-np.cos(theta_c))-cx*np.sin(theta_c))*(dy*dz*(1-np.cos(theta_d))+dx*np.sin(theta_d))+(np.cos(theta_a)+ax**2*(1-np.cos(theta_a)))*(np.cos(theta_b)+bx**2*(1-np.cos(theta_b)))*(cx*cz*(1-np.cos(theta_c))-cy*np.sin(theta_c))*(np.cos(theta_d)+dz**2*(1-np.cos(theta_d)))+(ax*ay*(1-np.cos(theta_a))+az*np.sin(theta_a))*(bx*by*(1-np.cos(theta_b))-bz*np.sin(theta_b))*(cx*cz*(1-np.cos(theta_c))-cy*np.sin(theta_c))*(np.cos(theta_d)+dz**2*(1-np.cos(theta_d)))+(ax*az*(1-np.cos(theta_a))-ay*np.sin(theta_a))*(bx*bz*(1-np.cos(theta_b))+by*np.sin(theta_b))*(cx*cz*(1-np.cos(theta_c))-cy*np.sin(theta_c))*(np.cos(theta_d)+dz**2*(1-np.cos(theta_d)))+(np.cos(theta_a)+ax**2*(1-np.cos(theta_a)))*(bx*by*(1-np.cos(theta_b))+bz*np.sin(theta_b))*(cy*cz*(1-np.cos(theta_c))+cx*np.sin(theta_c))*(np.cos(theta_d)+dz**2*(1-np.cos(theta_d)))+(ax*ay*(1-np.cos(theta_a))+az*np.sin(theta_a))*(np.cos(theta_b)+by**2*(1-np.cos(theta_b)))*(cy*cz*(1-np.cos(theta_c))+cx*np.sin(theta_c))*(np.cos(theta_d)+dz**2*(1-np.cos(theta_d)))+(ax*az*(1-np.cos(theta_a))-ay*np.sin(theta_a))*(by*bz*(1-np.cos(theta_b))-bx*np.sin(theta_b))*(cy*cz*(1-np.cos(theta_c))+cx*np.sin(theta_c))*(np.cos(theta_d)+dz**2*(1-np.cos(theta_d)))+(np.cos(theta_a)+ax**2*(1-np.cos(theta_a)))*(bx*bz*(1-np.cos(theta_b))-by*np.sin(theta_b))*(np.cos(theta_c)+cz**2*(1-np.cos(theta_c)))*(np.cos(theta_d)+dz**2*(1-np.cos(theta_d)))+(ax*ay*(1-np.cos(theta_a))+az*np.sin(theta_a))*(by*bz*(1-np.cos(theta_b))+bx*np.sin(theta_b))*(np.cos(theta_c)+cz**2*(1-np.cos(theta_c)))*(np.cos(theta_d)+dz**2*(1-np.cos(theta_d)))+(ax*az*(1-np.cos(theta_a))-ay*np.sin(theta_a))*(np.cos(theta_b)+bz**2*(1-np.cos(theta_b)))*(np.cos(theta_c)+cz**2*(1-np.cos(theta_c)))*(np.cos(theta_d)+dz**2*(1-np.cos(theta_d)))
	R[2,1] = (ax*ay*(1-np.cos(theta_a))-az*np.sin(theta_a))*(np.cos(theta_b)+bx**2*(1-np.cos(theta_b)))*(np.cos(theta_c)+cx**2*(1-np.cos(theta_c)))*(dx*dz*(1-np.cos(theta_d))-dy*np.sin(theta_d))+(np.cos(theta_a)+ay**2*(1-np.cos(theta_a)))*(bx*by*(1-np.cos(theta_b))-bz*np.sin(theta_b))*(np.cos(theta_c)+cx**2*(1-np.cos(theta_c)))*(dx*dz*(1-np.cos(theta_d))-dy*np.sin(theta_d))+(ay*az*(1-np.cos(theta_a))+ax*np.sin(theta_a))*(bx*bz*(1-np.cos(theta_b))+by*np.sin(theta_b))*(np.cos(theta_c)+cx**2*(1-np.cos(theta_c)))*(dx*dz*(1-np.cos(theta_d))-dy*np.sin(theta_d))+(ax*ay*(1-np.cos(theta_a))-az*np.sin(theta_a))*(bx*by*(1-np.cos(theta_b))+bz*np.sin(theta_b))*(cx*cy*(1-np.cos(theta_c))-cz*np.sin(theta_c))*(dx*dz*(1-np.cos(theta_d))-dy*np.sin(theta_d))+(np.cos(theta_a)+ay**2*(1-np.cos(theta_a)))*(np.cos(theta_b)+by**2*(1-np.cos(theta_b)))*(cx*cy*(1-np.cos(theta_c))-cz*np.sin(theta_c))*(dx*dz*(1-np.cos(theta_d))-dy*np.sin(theta_d))+(ay*az*(1-np.cos(theta_a))+ax*np.sin(theta_a))*(by*bz*(1-np.cos(theta_b))-bx*np.sin(theta_b))*(cx*cy*(1-np.cos(theta_c))-cz*np.sin(theta_c))*(dx*dz*(1-np.cos(theta_d))-dy*np.sin(theta_d))+(ax*ay*(1-np.cos(theta_a))-az*np.sin(theta_a))*(bx*bz*(1-np.cos(theta_b))-by*np.sin(theta_b))*(cx*cz*(1-np.cos(theta_c))+cy*np.sin(theta_c))*(dx*dz*(1-np.cos(theta_d))-dy*np.sin(theta_d))+(np.cos(theta_a)+ay**2*(1-np.cos(theta_a)))*(by*bz*(1-np.cos(theta_b))+bx*np.sin(theta_b))*(cx*cz*(1-np.cos(theta_c))+cy*np.sin(theta_c))*(dx*dz*(1-np.cos(theta_d))-dy*np.sin(theta_d))+(ay*az*(1-np.cos(theta_a))+ax*np.sin(theta_a))*(np.cos(theta_b)+bz**2*(1-np.cos(theta_b)))*(cx*cz*(1-np.cos(theta_c))+cy*np.sin(theta_c))*(dx*dz*(1-np.cos(theta_d))-dy*np.sin(theta_d))+(ax*ay*(1-np.cos(theta_a))-az*np.sin(theta_a))*(np.cos(theta_b)+bx**2*(1-np.cos(theta_b)))*(cx*cy*(1-np.cos(theta_c))+cz*np.sin(theta_c))*(dy*dz*(1-np.cos(theta_d))+dx*np.sin(theta_d))+(np.cos(theta_a)+ay**2*(1-np.cos(theta_a)))*(bx*by*(1-np.cos(theta_b))-bz*np.sin(theta_b))*(cx*cy*(1-np.cos(theta_c))+cz*np.sin(theta_c))*(dy*dz*(1-np.cos(theta_d))+dx*np.sin(theta_d))+(ay*az*(1-np.cos(theta_a))+ax*np.sin(theta_a))*(bx*bz*(1-np.cos(theta_b))+by*np.sin(theta_b))*(cx*cy*(1-np.cos(theta_c))+cz*np.sin(theta_c))*(dy*dz*(1-np.cos(theta_d))+dx*np.sin(theta_d))+(ax*ay*(1-np.cos(theta_a))-az*np.sin(theta_a))*(bx*by*(1-np.cos(theta_b))+bz*np.sin(theta_b))*(np.cos(theta_c)+cy**2*(1-np.cos(theta_c)))*(dy*dz*(1-np.cos(theta_d))+dx*np.sin(theta_d))+(np.cos(theta_a)+ay**2*(1-np.cos(theta_a)))*(np.cos(theta_b)+by**2*(1-np.cos(theta_b)))*(np.cos(theta_c)+cy**2*(1-np.cos(theta_c)))*(dy*dz*(1-np.cos(theta_d))+dx*np.sin(theta_d))+(ay*az*(1-np.cos(theta_a))+ax*np.sin(theta_a))*(by*bz*(1-np.cos(theta_b))-bx*np.sin(theta_b))*(np.cos(theta_c)+cy**2*(1-np.cos(theta_c)))*(dy*dz*(1-np.cos(theta_d))+dx*np.sin(theta_d))+(ax*ay*(1-np.cos(theta_a))-az*np.sin(theta_a))*(bx*bz*(1-np.cos(theta_b))-by*np.sin(theta_b))*(cy*cz*(1-np.cos(theta_c))-cx*np.sin(theta_c))*(dy*dz*(1-np.cos(theta_d))+dx*np.sin(theta_d))+(np.cos(theta_a)+ay**2*(1-np.cos(theta_a)))*(by*bz*(1-np.cos(theta_b))+bx*np.sin(theta_b))*(cy*cz*(1-np.cos(theta_c))-cx*np.sin(theta_c))*(dy*dz*(1-np.cos(theta_d))+dx*np.sin(theta_d))+(ay*az*(1-np.cos(theta_a))+ax*np.sin(theta_a))*(np.cos(theta_b)+bz**2*(1-np.cos(theta_b)))*(cy*cz*(1-np.cos(theta_c))-cx*np.sin(theta_c))*(dy*dz*(1-np.cos(theta_d))+dx*np.sin(theta_d))+(ax*ay*(1-np.cos(theta_a))-az*np.sin(theta_a))*(np.cos(theta_b)+bx**2*(1-np.cos(theta_b)))*(cx*cz*(1-np.cos(theta_c))-cy*np.sin(theta_c))*(np.cos(theta_d)+dz**2*(1-np.cos(theta_d)))+(np.cos(theta_a)+ay**2*(1-np.cos(theta_a)))*(bx*by*(1-np.cos(theta_b))-bz*np.sin(theta_b))*(cx*cz*(1-np.cos(theta_c))-cy*np.sin(theta_c))*(np.cos(theta_d)+dz**2*(1-np.cos(theta_d)))+(ay*az*(1-np.cos(theta_a))+ax*np.sin(theta_a))*(bx*bz*(1-np.cos(theta_b))+by*np.sin(theta_b))*(cx*cz*(1-np.cos(theta_c))-cy*np.sin(theta_c))*(np.cos(theta_d)+dz**2*(1-np.cos(theta_d)))+(ax*ay*(1-np.cos(theta_a))-az*np.sin(theta_a))*(bx*by*(1-np.cos(theta_b))+bz*np.sin(theta_b))*(cy*cz*(1-np.cos(theta_c))+cx*np.sin(theta_c))*(np.cos(theta_d)+dz**2*(1-np.cos(theta_d)))+(np.cos(theta_a)+ay**2*(1-np.cos(theta_a)))*(np.cos(theta_b)+by**2*(1-np.cos(theta_b)))*(cy*cz*(1-np.cos(theta_c))+cx*np.sin(theta_c))*(np.cos(theta_d)+dz**2*(1-np.cos(theta_d)))+(ay*az*(1-np.cos(theta_a))+ax*np.sin(theta_a))*(by*bz*(1-np.cos(theta_b))-bx*np.sin(theta_b))*(cy*cz*(1-np.cos(theta_c))+cx*np.sin(theta_c))*(np.cos(theta_d)+dz**2*(1-np.cos(theta_d)))+(ax*ay*(1-np.cos(theta_a))-az*np.sin(theta_a))*(bx*bz*(1-np.cos(theta_b))-by*np.sin(theta_b))*(np.cos(theta_c)+cz**2*(1-np.cos(theta_c)))*(np.cos(theta_d)+dz**2*(1-np.cos(theta_d)))+(np.cos(theta_a)+ay**2*(1-np.cos(theta_a)))*(by*bz*(1-np.cos(theta_b))+bx*np.sin(theta_b))*(np.cos(theta_c)+cz**2*(1-np.cos(theta_c)))*(np.cos(theta_d)+dz**2*(1-np.cos(theta_d)))+(ay*az*(1-np.cos(theta_a))+ax*np.sin(theta_a))*(np.cos(theta_b)+bz**2*(1-np.cos(theta_b)))*(np.cos(theta_c)+cz**2*(1-np.cos(theta_c)))*(np.cos(theta_d)+dz**2*(1-np.cos(theta_d)))
	R[2,2] = (ax*az*(1-np.cos(theta_a))+ay*np.sin(theta_a))*(np.cos(theta_b)+bx**2*(1-np.cos(theta_b)))*(np.cos(theta_c)+cx**2*(1-np.cos(theta_c)))*(dx*dz*(1-np.cos(theta_d))-dy*np.sin(theta_d))+(ay*az*(1-np.cos(theta_a))-ax*np.sin(theta_a))*(bx*by*(1-np.cos(theta_b))-bz*np.sin(theta_b))*(np.cos(theta_c)+cx**2*(1-np.cos(theta_c)))*(dx*dz*(1-np.cos(theta_d))-dy*np.sin(theta_d))+(np.cos(theta_a)+az**2*(1-np.cos(theta_a)))*(bx*bz*(1-np.cos(theta_b))+by*np.sin(theta_b))*(np.cos(theta_c)+cx**2*(1-np.cos(theta_c)))*(dx*dz*(1-np.cos(theta_d))-dy*np.sin(theta_d))+(ax*az*(1-np.cos(theta_a))+ay*np.sin(theta_a))*(bx*by*(1-np.cos(theta_b))+bz*np.sin(theta_b))*(cx*cy*(1-np.cos(theta_c))-cz*np.sin(theta_c))*(dx*dz*(1-np.cos(theta_d))-dy*np.sin(theta_d))+(ay*az*(1-np.cos(theta_a))-ax*np.sin(theta_a))*(np.cos(theta_b)+by**2*(1-np.cos(theta_b)))*(cx*cy*(1-np.cos(theta_c))-cz*np.sin(theta_c))*(dx*dz*(1-np.cos(theta_d))-dy*np.sin(theta_d))+(np.cos(theta_a)+az**2*(1-np.cos(theta_a)))*(by*bz*(1-np.cos(theta_b))-bx*np.sin(theta_b))*(cx*cy*(1-np.cos(theta_c))-cz*np.sin(theta_c))*(dx*dz*(1-np.cos(theta_d))-dy*np.sin(theta_d))+(ax*az*(1-np.cos(theta_a))+ay*np.sin(theta_a))*(bx*bz*(1-np.cos(theta_b))-by*np.sin(theta_b))*(cx*cz*(1-np.cos(theta_c))+cy*np.sin(theta_c))*(dx*dz*(1-np.cos(theta_d))-dy*np.sin(theta_d))+(ay*az*(1-np.cos(theta_a))-ax*np.sin(theta_a))*(by*bz*(1-np.cos(theta_b))+bx*np.sin(theta_b))*(cx*cz*(1-np.cos(theta_c))+cy*np.sin(theta_c))*(dx*dz*(1-np.cos(theta_d))-dy*np.sin(theta_d))+(np.cos(theta_a)+az**2*(1-np.cos(theta_a)))*(np.cos(theta_b)+bz**2*(1-np.cos(theta_b)))*(cx*cz*(1-np.cos(theta_c))+cy*np.sin(theta_c))*(dx*dz*(1-np.cos(theta_d))-dy*np.sin(theta_d))+(ax*az*(1-np.cos(theta_a))+ay*np.sin(theta_a))*(np.cos(theta_b)+bx**2*(1-np.cos(theta_b)))*(cx*cy*(1-np.cos(theta_c))+cz*np.sin(theta_c))*(dy*dz*(1-np.cos(theta_d))+dx*np.sin(theta_d))+(ay*az*(1-np.cos(theta_a))-ax*np.sin(theta_a))*(bx*by*(1-np.cos(theta_b))-bz*np.sin(theta_b))*(cx*cy*(1-np.cos(theta_c))+cz*np.sin(theta_c))*(dy*dz*(1-np.cos(theta_d))+dx*np.sin(theta_d))+(np.cos(theta_a)+az**2*(1-np.cos(theta_a)))*(bx*bz*(1-np.cos(theta_b))+by*np.sin(theta_b))*(cx*cy*(1-np.cos(theta_c))+cz*np.sin(theta_c))*(dy*dz*(1-np.cos(theta_d))+dx*np.sin(theta_d))+(ax*az*(1-np.cos(theta_a))+ay*np.sin(theta_a))*(bx*by*(1-np.cos(theta_b))+bz*np.sin(theta_b))*(np.cos(theta_c)+cy**2*(1-np.cos(theta_c)))*(dy*dz*(1-np.cos(theta_d))+dx*np.sin(theta_d))+(ay*az*(1-np.cos(theta_a))-ax*np.sin(theta_a))*(np.cos(theta_b)+by**2*(1-np.cos(theta_b)))*(np.cos(theta_c)+cy**2*(1-np.cos(theta_c)))*(dy*dz*(1-np.cos(theta_d))+dx*np.sin(theta_d))+(np.cos(theta_a)+az**2*(1-np.cos(theta_a)))*(by*bz*(1-np.cos(theta_b))-bx*np.sin(theta_b))*(np.cos(theta_c)+cy**2*(1-np.cos(theta_c)))*(dy*dz*(1-np.cos(theta_d))+dx*np.sin(theta_d))+(ax*az*(1-np.cos(theta_a))+ay*np.sin(theta_a))*(bx*bz*(1-np.cos(theta_b))-by*np.sin(theta_b))*(cy*cz*(1-np.cos(theta_c))-cx*np.sin(theta_c))*(dy*dz*(1-np.cos(theta_d))+dx*np.sin(theta_d))+(ay*az*(1-np.cos(theta_a))-ax*np.sin(theta_a))*(by*bz*(1-np.cos(theta_b))+bx*np.sin(theta_b))*(cy*cz*(1-np.cos(theta_c))-cx*np.sin(theta_c))*(dy*dz*(1-np.cos(theta_d))+dx*np.sin(theta_d))+(np.cos(theta_a)+az**2*(1-np.cos(theta_a)))*(np.cos(theta_b)+bz**2*(1-np.cos(theta_b)))*(cy*cz*(1-np.cos(theta_c))-cx*np.sin(theta_c))*(dy*dz*(1-np.cos(theta_d))+dx*np.sin(theta_d))+(ax*az*(1-np.cos(theta_a))+ay*np.sin(theta_a))*(np.cos(theta_b)+bx**2*(1-np.cos(theta_b)))*(cx*cz*(1-np.cos(theta_c))-cy*np.sin(theta_c))*(np.cos(theta_d)+dz**2*(1-np.cos(theta_d)))+(ay*az*(1-np.cos(theta_a))-ax*np.sin(theta_a))*(bx*by*(1-np.cos(theta_b))-bz*np.sin(theta_b))*(cx*cz*(1-np.cos(theta_c))-cy*np.sin(theta_c))*(np.cos(theta_d)+dz**2*(1-np.cos(theta_d)))+(np.cos(theta_a)+az**2*(1-np.cos(theta_a)))*(bx*bz*(1-np.cos(theta_b))+by*np.sin(theta_b))*(cx*cz*(1-np.cos(theta_c))-cy*np.sin(theta_c))*(np.cos(theta_d)+dz**2*(1-np.cos(theta_d)))+(ax*az*(1-np.cos(theta_a))+ay*np.sin(theta_a))*(bx*by*(1-np.cos(theta_b))+bz*np.sin(theta_b))*(cy*cz*(1-np.cos(theta_c))+cx*np.sin(theta_c))*(np.cos(theta_d)+dz**2*(1-np.cos(theta_d)))+(ay*az*(1-np.cos(theta_a))-ax*np.sin(theta_a))*(np.cos(theta_b)+by**2*(1-np.cos(theta_b)))*(cy*cz*(1-np.cos(theta_c))+cx*np.sin(theta_c))*(np.cos(theta_d)+dz**2*(1-np.cos(theta_d)))+(np.cos(theta_a)+az**2*(1-np.cos(theta_a)))*(by*bz*(1-np.cos(theta_b))-bx*np.sin(theta_b))*(cy*cz*(1-np.cos(theta_c))+cx*np.sin(theta_c))*(np.cos(theta_d)+dz**2*(1-np.cos(theta_d)))+(ax*az*(1-np.cos(theta_a))+ay*np.sin(theta_a))*(bx*bz*(1-np.cos(theta_b))-by*np.sin(theta_b))*(np.cos(theta_c)+cz**2*(1-np.cos(theta_c)))*(np.cos(theta_d)+dz**2*(1-np.cos(theta_d)))+(ay*az*(1-np.cos(theta_a))-ax*np.sin(theta_a))*(by*bz*(1-np.cos(theta_b))+bx*np.sin(theta_b))*(np.cos(theta_c)+cz**2*(1-np.cos(theta_c)))*(np.cos(theta_d)+dz**2*(1-np.cos(theta_d)))+(np.cos(theta_a)+az**2*(1-np.cos(theta_a)))*(np.cos(theta_b)+bz**2*(1-np.cos(theta_b)))*(np.cos(theta_c)+cz**2*(1-np.cos(theta_c)))*(np.cos(theta_d)+dz**2*(1-np.cos(theta_d)))
	return R